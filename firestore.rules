/**
 * @file Firebase Security Rules for Inox PriceCalc
 *
 * @description This ruleset provides basic read access to product catalogs and enforces write access only via
 * authenticated service accounts or trusted cloud functions.
 *
 * Core Philosophy:
 * - Provides open read access to product catalogs (categories, items, settings).
 * - Protects write access to the live scale data collection to prevent unauthorized modifications.
 *   A trusted backend service or function should be used to write scale data.
 *
 * Data Structure:
 * - /inox_item_categories/{inoxItemCategoryId}: Stores item categories (e.g., tubes, sheets).
 * - /inox_items/{inoxItemId}: Stores individual product information.
 * - /universal_settings/{universalSettingsId}: Contains global pricing settings.
 * - /scale_data/{scaleDataId}: Stores live scale readings.
 *
 * Key Security Decisions:
 * - No user-specific data or ownership, so path-based ownership is not applied.
 * - Read access is generally open to allow for easy data retrieval.
 * - Write access to `scale_data` is denied to all clients to protect data integrity.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows anyone to read inox item categories. Writes are denied.
     * @path /inox_item_categories/{inoxItemCategoryId}
     * @allow (get, list): if true
     * @deny (create, update, delete): Always
     * @principle Allows public read access to item categories.
     */
    match /inox_item_categories/{inoxItemCategoryId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows anyone to read inox items. Writes are denied.
     * @path /inox_items/{inoxItemId}
     * @allow (get, list): if true
     * @deny (create, update, delete): Always
     * @principle Allows public read access to item data.
     */
    match /inox_items/{inoxItemId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows anyone to read universal settings. Writes are denied.
     * @path /universal_settings/{universalSettingsId}
     * @allow (get, list): if true
     * @deny (create, update, delete): Always
     * @principle Allows public read access to universal settings.
     */
    match /universal_settings/{universalSettingsId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Denies all access to the scale_data collection to clients. This collection should only be written to from a trusted backend.
     * @path /scale_data/{scaleDataId}
     * @allow (get, list): if false
     * @allow (create, update, delete): if false
     * @principle Restricts write access to a trusted backend service.
     */
    match /scale_data/{scaleDataId} {
      allow get, list: if false;
      allow create, update, delete: if false;
    }
    
    /**
     * @description Denies all access to the pesagens/live document due to insufficient permissions.
     * @path /pesagens/live
     * @allow get, list: if false
     * @allow create, update, delete: if false
     * @principle Prevents unauthorized access to pesagens/live document.
     */
    match /pesagens/live {
        allow get, list: if false;
        allow create, update, delete: if false;
    }
  }
}