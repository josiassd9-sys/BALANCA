/**
 * @file Firebase Security Rules for Inox PriceCalc
 *
 * @description This ruleset provides basic security for the Inox PriceCalc application.
 * All core catalog data (item categories, items, and universal settings) is publicly readable.
 * Scale data is writeable by a trusted source (e.g., a Cloud Function authenticated with a service account).
 *
 * @dataStructure
 * - `/inox_item_categories/{inoxItemCategoryId}`: Stores categories of stainless steel items.
 * - `/inox_items/{inoxItemId}`: Stores specific stainless steel items with their specifications and pricing.
 * - `/universal_settings/{universalSettingsId}`: Stores the universal cost and margin settings.
 * - `/scale_data/{scaleDataId}`: Stores live scale data.
 *
 * @keySecurityDecisions
 * - Read access to item categories, items, and universal settings is public.
 * - Write access to scale data is not user-dependent and will be handled by a trusted source.
 * - No user-specific private data exists in this model.
 * - Listing of collections is generally allowed for prototyping and quick access to all documents.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Manages access to stainless steel item categories.
     * @path /inox_item_categories/{inoxItemCategoryId}
     * @allow (get, list) All users can read item categories.
     * @deny (create, update, delete) No user can create, update, or delete item categories directly.
     * @principle Allows public read access to item categories.
     */
    match /inox_item_categories/{inoxItemCategoryId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Manages access to specific stainless steel items.
     * @path /inox_items/{inoxItemId}
     * @allow (get, list) All users can read item details.
     * @deny (create, update, delete) No user can create, update, or delete items directly.
     * @principle Allows public read access to item details.
     */
    match /inox_items/{inoxItemId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Manages access to universal settings.
     * @path /universal_settings/{universalSettingsId}
     * @allow (get, list) All users can read universal settings.
     * @deny (create, update, delete) No user can create, update, or delete universal settings directly.
     * @principle Allows public read access to universal settings.
     */
    match /universal_settings/{universalSettingsId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Manages access to live scale data.
     * @path /scale_data/{scaleDataId}
     * @allow (get, list) All users can read scale data.
     * @deny (create, update, delete) No user can create, update, or delete scale data directly.
     * @principle Allows public read access to scale data.
     */
    match /scale_data/{scaleDataId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description This match statement has been added because the error log provided specifies that the app attempts to read the document at /pesagens/live.
     * As there is no information regarding the schema of documents held under `pesagens` this access is open to all users for prototyping purposes.
     * @path /pesagens/live
     * @allow (get) All users can read scale data.
     * @deny (create, update, delete, list) No user can create, update, or delete scale data directly.
     * @principle Allows public read access to scale data.
     */
    match /pesagens/live {
      allow get: if true;
      allow create, update, delete, list: if false;
    }
  }
}